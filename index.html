<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>顧客離反分析ダッシュボード - 高島平店</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
        mermaid.initialize({ startOnLoad: true, theme: 'neutral' });
    </script>
    <style>
        :root {
            --navy-bg: #001f3f;
            --navy-card: #002b55;
            --navy-light: #003366;
            --gold: #c5a059;
            --text-white: #ffffff;
            --text-gray: #b0c4de;
            --bg-body: #f0f2f5;
        }
        body { font-family: "Segoe UI", "Hiragino Kaku Gothic ProN", sans-serif; background-color: var(--bg-body); margin: 0; color: #333; }
        
        /* Header */
        header { background-color: var(--navy-bg); color: var(--text-white); padding: 20px 40px; border-bottom: 3px solid var(--gold); display: flex; justify-content: space-between; align-items: center; }
        header h1 { margin: 0; font-size: 22px; letter-spacing: 1px; }
        .date-badge { background: var(--gold); color: var(--navy-bg); padding: 5px 15px; border-radius: 20px; font-weight: bold; font-size: 13px; }

        /* Dashboard Layout */
        .dashboard-container { padding: 30px; max-width: 1200px; margin: 0 auto; }
        .grid-kpi { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 30px; }
        .kpi-card { background: var(--navy-card); color: var(--text-white); padding: 20px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); border-top: 4px solid var(--gold); }
        .kpi-card .label { font-size: 12px; color: var(--text-gray); font-weight: bold; text-transform: uppercase; }
        .kpi-card .value { font-size: 32px; font-weight: bold; margin: 5px 0; color: var(--gold); }
        .kpi-card .subtext { font-size: 11px; opacity: 0.8; }

        .main-grid { display: grid; grid-template-columns: 2fr 1fr; gap: 20px; margin-bottom: 30px; }
        .chart-container { background: white; padding: 25px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        .chart-container h3 { margin-top: 0; font-size: 16px; border-left: 4px solid var(--navy-bg); padding-left: 10px; }

        /* Flowchart */
        .flow-section { background: white; padding: 30px; border-radius: 8px; margin-bottom: 30px; text-align: center; }
        .mermaid { margin-top: 20px; }

        /* Analysis Text Area */
        .analysis-section { background: white; padding: 40px; border-radius: 8px; line-height: 1.8; margin-bottom: 30px; }
        .analysis-section h2 { color: var(--navy-main); border-bottom: 2px solid #eee; padding-bottom: 10px; margin-top: 40px; }
        .analysis-section h3 { color: var(--navy-light); font-size: 18px; margin-top: 25px; }
        .alert-box { background: #fff9e6; border-left: 5px solid var(--gold); padding: 20px; margin: 20px 0; border-radius: 4px; }

        /* Footer */
        .strategy-footer { background: var(--navy-bg); color: white; padding: 40px; border-radius: 8px; }
        .strategy-footer h2 { color: var(--gold); margin-top: 0; }
        .strategy-item { margin-bottom: 20px; border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 15px; }
        .strategy-item strong { display: block; margin-bottom: 5px; font-size: 17px; color: var(--gold); }
    </style>
</head>
<body>

<header>
    <h1>顧客離反傾向分析・戦略ダッシュボード</h1>
    <div class="date-badge">高島平店 | 2025年10月-12月実績</div>
</header>

<div class="dashboard-container">
    
    <div class="grid-kpi">
        <div class="kpi-card">
            <div class="label">総離反会員数</div>
            <div class="value">828</div>
            <div class="subtext">前四半期比 分析対象</div>
        </div>
        <div class="kpi-card">
            <div class="label">AIアラート捕捉率</div>
            <div class="value">60.9%</div>
            <div class="subtext">504名が事前に予測対象</div>
        </div>
        <div class="kpi-card">
            <div class="label">Pオンリー遊技比率</div>
            <div class="value">44.7%</div>
            <div class="subtext">単一スタイル層の離脱が顕著</div>
        </div>
        <div class="kpi-card">
            <div class="label">平日平均来店回数</div>
            <div class="value">2.00</div>
            <div class="subtext">休日(0.94)の約2.1倍</div>
        </div>
    </div>

    <div class="main-grid">
        <div class="chart-container">
            <h3>離反顧客属性別のAIアラート検知状況</h3>
            <canvas id="alertChart" height="150"></canvas>
        </div>
        <div class="chart-container">
            <h3>遊技種別構成比</h3>
            <canvas id="machinePieChart"></canvas>
        </div>
    </div>

    <div class="flow-section">
        <h3>顧客属性遷移と離反フローの可視化</h3>
        <div class="mermaid">
            graph LR
                A[絆継続会員] -->|45.6% 検知| B(AIアラート作動)
                A -->|54.4% 漏れ| C{サイレント離反}
                D[復活会員] -->|期待値不足| C
                E[新規/低頻度] -->|定着失敗| C
                B --> F[対策打込可能]
                C --> G[離反確定]
                F --> G
                style A fill:#e1f5fe,stroke:#01579b
                style C fill:#ffebee,stroke:#c62828
                style G fill:#333,stroke:#000,color:#fff
        </div>
    </div>

    <div class="analysis-section">
        <h2>1. 来店パターンの傾向：平日・昼間層の脆弱性</h2>
        <p>離反会員の来店傾向を分析したところ、休日に比べ<strong>平日の利用頻度が高い顧客</strong>の離脱が目立ちます。平日の平均来店回数は2.00回であり、休日（0.94回）の2倍以上に達しています。特に昼間来店回数が多い（平均2回以上）層は、店舗を生活サイクルに組み込んでいた可能性が高く、その層が辞めることは「習慣の断絶」を意味し、回復が困難な離反と言えます。</p>

        <h2>2. 遊技種別とスタイルの偏り：Pオンリーの定着難</h2>
        <p>遊技スタイルでは、複数の種別を回遊せず「1つのスタイルに固執する」顧客の離反が顕著です。Pオンリー（パチンコのみ）ユーザーが44.7%と最大のボリュームを占めており、機種の不調や飽きを分散できず離脱する傾向にあります。対照的に、P&S両方を回遊するユーザーの離反率は低く、店舗内での回遊性が定着の鍵となっています。</p>

        <h2>3. 離反前属性の推移：どの状態から離反しやすいか</h2>
        <h3>① 絆継続・継続会員の「習慣消失」型</h3>
        <p>3ヶ月連続で「絆継続」だったにも関わらず離反したケースが約10%（87名）存在します。長年の常連であっても「ある日突然」来店が止まるリスクを示しています。</p>
        <h3>② 復活直後の「再離脱」型</h3>
        <p>「1ヶ月前または2ヶ月前に復活したばかり」の会員が離反するケースも約10%に達し、復活時の再評価で定着に失敗しています。</p>

        <h2>4. AIアラートの的中精度と活用の現状</h2>
        <div class="alert-box">
            <strong>【重要】絆継続会員のアラート捕捉率は44.7%と低迷。</strong><br>
            ロイヤル層ほど数値に現れない「不満」が先行し、AIが検知する前に離反する「サイレント離反」が発生しています。
        </div>
    </div>

    <div class="strategy-footer">
        <h2>次期に向けた重点実施事項</h2>
        <div class="strategy-item">
            <strong>1. 「絆客」への非デジタル・ケアの徹底</strong>
            <p>AIアラート検知率が低い「絆客（ロイヤル層）」に対し、数値化される前の不満を現場で察知する必要があります。「平日昼間の特定機種でのハマり」などをトリガーに、現場での積極的なフォローを実施してください。</p>
        </div>
        <div class="strategy-item">
            <strong>2. 復活会員への「2回目来店」確約施策</strong>
            <p>復活した会員の離反が多いため、再来店から1ヶ月以内を最重要保護期間とし、再定着のためのインセンティブや動機付けを集中させます。</p>
        </div>
        <div class="strategy-item">
            <strong>3. Pオンリー層の「回遊」促進</strong>
            <p>離反率が最も高いPオンリー層に対し、他種別への興味喚起を行い、単一機種の稼働状況に左右されない顧客基盤を構築します。</p>
        </div>
    </div>

</div>

<script>
    // Machine Type Pie Chart
    const ctxPie = document.getElementById('machinePieChart').getContext('2d');
    new Chart(ctxPie, {
        type: 'doughnut',
        data: {
            labels: ['20Sメイン', '1Pメイン', '4Pメイン'],
            datasets: [{
                data: [415, 228, 185],
                backgroundColor: ['#003366', '#c5a059', '#b0c4de'],
                hoverOffset: 4
            }]
        },
        options: { plugins: { legend: { position: 'bottom' } } }
    });

    // AI Alert Bar Chart
    const ctxBar = document.getElementById('alertChart').getContext('2d');
    new Chart(ctxBar, {
        type: 'bar',
        data: {
            labels: ['継続', '絆継続', '離脱復活', '1ヶ月復活', '2ヶ月復活', '新規'],
            datasets: [
                {
                    label: 'AI検知あり',
                    data: [185, 62, 88, 74, 43, 33],
                    backgroundColor: '#003366'
                },
                {
                    label: 'AI検知なし',
                    data: [114, 74, 38, 34, 26, 27],
                    backgroundColor: '#e0e0e0'
                }
            ]
        },
        options: {
            scales: { y: { stacked: true }, x: { stacked: true } },
            plugins: { legend: { position: 'top' } }
        }
    });
</script>

</body>
</html>
